I"™<p>Iâ€™ve been experimenting a bit with a cute blogging engine called 
<a href="http://cloudhead.io/toto">Toto</a> and wanted to migrate my Posterous posts so I wrote a little script in Ruby to download them all and format them in a Toto-appropriate way.</p>

<p>This script uses the posterous gem just to retrieve each post and put it in a YAML text file that Toto can understand. At the moment there are a few problemsâ€¦</p>

<ul>
  <li>Since YAML uses â€œ:â€ as a control character I had to remove any colons from titles and replaced them with dashesâ€¦ I wonder if thereâ€™s a way to preserve them so that the text files are still human-readable?</li>
  <li>The posterous gem only seems to get one page of posts at a time since my blog has 19 pages, I just ran my downloading method for each one.</li>
</ul>

<p>Anyway, hereâ€™s the script! Maybe someone will chime in and tell me all the things Iâ€™m doing wrong:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#!/usr/bin/env ruby

require 'posterous'
require 'toto'

Posterous.config = {
Â  'username'Â  =&gt; 'username',
Â  'password'Â  =&gt; 'password',
Â  'api_token' =&gt; 'api_token'
}

include Posterous

@site = Site.primary

Dir.chdir( "~/src/posterousparser" )

def saveposts(pagenumber = 0)
Â  @site.posts(:page =&gt; pagenumber).each do |e|
Â  Â  timestamp = e.display_date
Â  Â  yyyy = timestamp[0..3]
Â  Â  mm = timestamp[5..6]
Â  Â  dd = timestamp[8..9]

Â  Â  title = e.title.gsub(":", "-")
Â  Â  slug = title.strip.slugize
Â  Â  filename = "#{yyyy}-#{mm}-#{dd}-#{slug}.txt"

Â  Â  puts "Writing #{filename}...\n"

Â  Â  file = File.new("#{filename}", "w")
Â  Â  file.puts "---\n"
Â  Â  file.puts "title: #{title}\n"
Â  Â  file.puts "author: #{e.user["display_name"]}"
Â  Â  file.puts "date: #{dd}/#{mm}/#{yyyy}\n"
Â  Â  file.puts "timestamp: #{e.display_date}\n"

Â  Â  file.print "tags: "

Â  Â  e.tags.each do |a|
Â  Â  Â  file.print "#{a["name"]} "
Â  Â  end

Â  Â  file.puts "\n\n"
Â  Â  file.puts "#{e.body_full}\n"
Â  Â  file.puts "\n"
Â  Â  file.close

Â  end
end

puts "Downloading posts now!"

for i in 1..19 do
Â  saveposts(i)
end
</code></pre></div></div>
:ET